---
title: 要素とのやりとり
---

# 動作可能性

Cypressの中にはDOMとやりとりするコマンドがある。

例
- `.click()`
- `.dbclick()`
- `.type()`
- `.clear()`
- `.check()`
- `.uncheck()`
- `.select()`
- `.trigger()`

## 実行されるチェックと動作

- 要素が見える範囲までスクロールする。
- 要素が非表示でないことを確認する。
- 要素が使用不可でないことを確認する。
- 要素が読み取り専用でないことを確認する。
- 要素が動いていないことを確認する。
- 要素が覆われていないことを確認する。
- 位置固定の要素によってまだ覆われている場合はページをスクロールする。
- 望ましい座標でイベントを発火させる。

Cypressが対象の要素とやりとりできない場合は常に、上記のステップのいずれかで失敗する。通常、なぜ要素が動作可能な状態で見つからないかを説明するエラー情報を得られる。

## 可視性

Cypressは要素の可視性を判断するために多くのことをチェックする。

**要素がもし次の通りであれば隠れていると判定される:**

- 幅か高さが0。
- CSSプロパティ(または上位の要素)が`visibility: hidden`。
- CSSプロパティ(または上位の要素)が`display: none`。
- CSSプロパティが`position: fixed`で、表示範囲外か別の要素で覆われている。

**さらに、要素が次の通りであれば隠れていると判定される:**

- 上位要素のいずれかが**overflow*を隠している**
    - かつ、その上位要素が0の幅か高さを持っている。
    - かつ、上位要素と対象要素の間の要素が`position: absolute`。
- 上位要素のいずれかが**overflow*を隠している**
    - かつ、その上位要素か、その上位要素とそのまた上位要素の間の上位要素がオフセットの親である。（？理解できていない）
    - かつ、それが上位要素の境界の外側に配置されている。
- 上位要素のいずれかが**overflow*を隠している**
    - かつ、その要素が`position: relative`。
    - かつ、それが上位要素の境界の外側に配置されている。

**overflow*を隠している**とは、次のプロパティのいずれかを持っていることを意味する: `overflow: hidden`, `overflow-x: hidden`, `overflow-y: hidden`, `overflow: scroll`, `overflow: auto`

## 使用不可性

Cypressは要素の`disabled`プロパティが`true`かチェックする。

## 読み取り専用

Cypressは`.type()`の間に`readonly`プロパティがセットされているかチェックする。

## アニメーション

Cypressは要素が動いているかどうかを自動的に判定し、止まるまで待機する。

要素が動いているかを判定するために、その要素があった最後の位置を取得し、要素の傾きを計算する。（アメリカでは8年生の代数で学習する？）

要素が動いているかを判定するために、現在の位置と前の位置をチェックする。もし、その距離が[`animationDistanceThreshold`](https://docs.cypress.io/guides/references/configuration.html#Animations)を超えている場合は、その要素が動いていると判定する。

　[この閾値は変更できる。](https://docs.cypress.io/guides/references/configuration.html#Animations)

